<div class="p-8 space-y-8">

  <!-- Header Info -->
  <div class="flex items-start justify-between gap-4 mb-2">
    <div>
      <h1 class="text-3xl font-extrabold text-white mb-2 flex items-center gap-2">
        <i class="fa-solid fa-envelope-open-text text-indigo-400"></i>
        Message Details
      </h1>
      <div class="text-base text-gray-300 mt-1">
        From <span class="text-indigo-100 font-bold"><%= @contact_message.name %></span>
        (<span class="font-mono text-cyan-400"><%= @contact_message.email %></span>)
        &middot; <%= @contact_message.created_at.strftime("%b %d, %Y %H:%M") %>
      </div>
    </div>
    <% unless @contact_message.read? %>
      <%= button_to "Mark as read",
          mark_read_admin_contact_message_path(@contact_message),
          method: :patch,
          class: "px-4 py-2 mt-2 rounded-xl bg-emerald-600 hover:bg-emerald-500 text-sm font-bold shadow" %>
    <% end %>
  </div>

  <!-- Subject and customer message -->
  <div class="rounded-2xl bg-gradient-to-tr from-indigo-700 via-indigo-900 to-cyan-950 border-2 border-indigo-400/30 shadow-xl p-6 mb-4">
    <div class="flex items-center gap-3 mb-2">
      <div class="h-12 w-12 rounded-full bg-indigo-200 flex items-center justify-center font-bold text-indigo-800 text-2xl">
        <i class="fa-regular fa-user"></i>
      </div>
      <div>
        <div class="text-base text-gray-200">
          <strong>Subject:</strong> <span class="text-indigo-50"><%= @contact_message.subject.presence || "—" %></span>
        </div>
        <div class="text-xs text-indigo-200 mt-0.5">
          <i class="fa-regular fa-clock"></i>
          <%= @contact_message.created_at.strftime("%b %d, %Y %H:%M") %>
        </div>
      </div>
    </div>
    <div class="mt-2 text-white text-lg font-semibold tracking-wide">“<%= @contact_message.message %>”</div>
  </div>

  <!-- Admin reply or reply form -->
  <% if @contact_message.reply.present? %>
    <div class="rounded-2xl bg-gradient-to-r from-emerald-600 via-emerald-800 to-cyan-800 border-2 border-emerald-400/30 shadow-xl p-6 relative">
      <div class="flex items-center mb-2">
        <div class="h-12 w-12 rounded-full bg-emerald-100 flex items-center justify-center font-bold text-emerald-700 text-2xl mr-3 shadow">
          <i class="fa-solid fa-user-shield"></i>
        </div>
        <span class="font-semibold text-white text-lg">Your Reply</span>
      </div>
      <div class="text-sm text-emerald-100 mb-2">
        <i class="fa-regular fa-clock mr-1"></i>
        <%= @contact_message.reply_at&.strftime("%b %d, %Y %H:%M") %>
      </div>
      <div class="mt-1 text-white text-base italic">“<%= @contact_message.reply %>”</div>
    </div>
  <% else %>
    <div class="rounded-2xl bg-gradient-to-bl from-gray-900/80 via-slate-900/80 to-gray-800/70 border-2 border-white/10 shadow-xl p-6 relative">
      <h3 class="text-xl font-extrabold mb-2 text-indigo-200 flex items-center gap-2">
        <i class="fa-solid fa-reply text-emerald-400"></i>
        Send a Reply to Customer
      </h3>
      <%= form_with model: @contact_message, url: reply_admin_contact_message_path(@contact_message), method: :patch, local: true do |f| %>
        <div class="mb-4">
          <%= f.text_area :reply,
              class: "w-full p-3 rounded-lg bg-slate-900 border border-emerald-400/20 text-gray-100 focus:ring focus:ring-emerald-400/30",
              rows: 4,
              placeholder: "Type your thoughtful reply..." %>
        </div>
        <%= f.submit "Send Reply", class: "px-5 py-2 bg-emerald-600 hover:bg-emerald-500 rounded-xl font-bold text-white transition shadow-md" %>
      <% end %>
    </div>
  <% end %>
</div>