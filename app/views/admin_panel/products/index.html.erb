<main class="px-4 py-10 min-h-screen" style="background: linear-gradient(100deg, #f0f4fc 60%, #e6ecfa 100%);">
  <div class="max-w-6xl mx-auto">

    <!-- HEADER -->
    <div class="flex flex-col lg:flex-row lg:items-end lg:justify-between gap-4 mb-8">
      <div>
        <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gradient-to-r from-indigo-600 to-blue-400 text-xs font-bold text-white mb-4 shadow">
          <span class="h-2 w-2 rounded-full bg-white/80"></span>
          Premium Catalog
        </div>
        <h1 class="text-4xl font-extrabold text-indigo-700 tracking-tight mb-2">Products</h1>
        <p class="text-base text-blue-700 mt-1 mb-3 font-medium">Manage products, featured items, pricing, and inventory.</p>
      </div>
      <div class="flex items-center gap-3">
        <%= link_to "New Product",
              new_admin_product_path,
              class: "px-5 py-2 rounded-xl text-white text-base font-bold shadow-lg border-0 transition",
              style: "background: linear-gradient(90deg, #ec4899 0%, #6366f1 100%);" %>
        <%= link_to admin_dashboard_path,
              class: "px-5 py-2 rounded-xl border-0 bg-gradient-to-r from-gray-300 to-gray-100 text-gray-800 text-sm font-bold shadow-sm flex items-center gap-2 hover:from-indigo-200 hover:to-blue-50 transition" do %>
          <i class="fas fa-arrow-left"></i> Back
        <% end %>
      </div>
    </div>

    <!-- SEARCH BOX -->
    <div class="rounded-xl bg-gradient-to-r from-cyan-50 via-white to-indigo-100 p-6 mb-8 border border-blue-100/70 shadow flex flex-col md:flex-row md:items-center gap-6">
      <div class="flex-1">
        <label class="block text-xs font-semibold text-blue-700 mb-2">Search</label>
        <input type="text"
               placeholder="ðŸ”Ž Search by name, SKU, brand..."
               class="w-full px-5 py-3 rounded-full border border-blue-200 text-indigo-800 font-medium bg-indigo-50 focus:outline-none focus:ring-2 focus:ring-pink-300 shadow placeholder-blue-400" />
      </div>
      <div class="flex items-end gap-2">
        <div>
          <label class="block text-xs font-semibold text-blue-700 mb-2">Stats</label>
          <div class="flex items-center gap-2">
            <span class="px-4 py-2 rounded-xl text-xs font-bold bg-pink-100 text-pink-700 shadow">
              Total: <%= @products.respond_to?(:count) ? @products.count : 0 %>
            </span>
            <% if defined?(Product) && Product.column_names.include?("featured") %>
              <span class="px-4 py-2 rounded-xl text-xs font-bold bg-emerald-100 text-emerald-700 shadow">
                Featured: <%= Product.where(featured: true).count %>
              </span>
            <% end %>
          </div>
        </div>
      </div>
    </div>

    <!-- TABLE -->
    <div class="rounded-xl shadow-2xl border border-blue-200/70 overflow-hidden bg-white/95">

      <div class="px-6 py-5 border-b border-blue-100 bg-gradient-to-r from-indigo-50 to-blue-100">
        <h2 class="text-xl font-bold text-indigo-900 mb-1 flex items-center gap-2">
          <i class="fa-solid fa-boxes-stacked text-pink-400"></i> All Products
        </h2>
        <p class="text-xs text-blue-500">Fast actions + clean overview</p>
      </div>
      <div class="overflow-x-auto">
        <table class="min-w-full text-base">
          <thead class="bg-gradient-to-r from-blue-50 to-indigo-100">
            <tr>
              <th class="px-5 py-4 font-extrabold text-pink-600 text-sm">Product</th>
              <th class="px-5 py-4 font-extrabold text-indigo-600 text-sm">Category</th>
              <th class="px-5 py-4 font-extrabold text-cyan-700 text-sm">Brand</th>
              <th class="px-5 py-4 font-extrabold text-emerald-700 text-sm">Price</th>
              <th class="px-5 py-4 font-extrabold text-fuchsia-700 text-sm">Featured</th>
              <th class="px-5 py-4 font-extrabold text-rose-700 text-right text-sm" style="min-width: 250px;">Actions</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-indigo-50">
            <% if @products.blank? %>
              <tr>
                <td colspan="6" class="px-5 py-10 text-center text-blue-400 font-bold">
                  No products found.
                </td>
              </tr>
            <% else %>
              <% @products.each do |p| %>
                <% featured = p.respond_to?(:featured) ? !!p.featured : false %>
                <tr class="hover:bg-gradient-to-l hover:from-pink-50 hover:to-indigo-50 transition">
                  <td class="px-5 py-5 text-indigo-800 font-semibold">
                    <div class="flex items-center gap-3">
                      <div class="h-10 w-10 rounded-xl border border-pink-200 bg-pink-50 overflow-hidden flex items-center justify-center shadow">
                        <% if p.respond_to?(:image) && p.image.present? %>
                          <%= image_tag p.image, class: "h-full w-full object-cover" %>
                        <% elsif p.respond_to?(:images) && p.images.respond_to?(:attached?) && p.images.attached? %>
                          <%= image_tag url_for(p.images.first), class: "h-full w-full object-cover" %>
                        <% else %>
                          <span class="text-indigo-400 text-xs font-bold">IMG</span>
                        <% end %>
                      </div>
                      <div class="min-w-0">
                        <div class="font-extrabold text-indigo-800 truncate"><%= p.try(:name) || "Product ##{p.id}" %></div>
                        <div class="text-xs text-blue-600 truncate font-mono">
                          ID: <span class="bg-blue-50 text-blue-700 rounded px-2 py-0.5"><%= p.id %></span>
                          <% if p.respond_to?(:sku) && p.sku.present? %>
                            â€¢ SKU: <span class="text-cyan-700 font-bold"><%= p.sku %></span>
                          <% end %>
                        </div>
                      </div>
                    </div>
                  </td>
                  <td class="px-5 py-5 text-pink-700 font-bold bg-pink-50"><%= p.try(:category).try(:name) || (p.respond_to?(:category_name) ? p.category_name : "â€”") %></td>
                  <td class="px-5 py-5 text-cyan-700 font-bold bg-cyan-50"><%= p.try(:brand).try(:name) || (p.respond_to?(:brand_name) ? p.brand_name : "â€”") %></td>
                  <td class="px-5 py-5 text-lg text-emerald-700 font-extrabold">
                    <% if p.respond_to?(:price) && p.price.present? %>
                      <%= number_to_currency(p.price) rescue p.price %>
                    <% elsif p.respond_to?(:price_cents) && p.price_cents.present? %>
                      <%= number_to_currency(p.price_cents.to_i / 100.0) %>
                    <% else %>
                      â€”
                    <% end %>
                  </td>
                  <td class="px-5 py-5 text-center">
                    <% if featured %>
                      <span class="inline-flex items-center px-4 py-1 rounded-full text-xs font-bold bg-gradient-to-r from-emerald-400 to-green-400 text-white shadow border-0" style="letter-spacing:.05em;">
                        <i class="fa-solid fa-star text-yellow-200 mr-1"></i> Featured
                      </span>
                    <% else %>
                      <span class="inline-flex items-center px-4 py-1 rounded-full text-xs font-bold bg-gradient-to-r from-gray-300 to-gray-400 text-gray-700 shadow border-0">
                        Normal
                      </span>
                    <% end %>
                  </td>
                  <td class="px-5 py-5 text-right" style="min-width:250px;">
                    <div class="flex items-center justify-end gap-2 flex-nowrap">
                      <%= link_to "View",
                            admin_product_path(p),
                            class: "px-4 py-2 rounded-full bg-blue-500 text-white font-bold border-0 shadow hover:bg-blue-600 transition" %>
                      <%= link_to "Edit",
                            edit_admin_product_path(p),
                            class: "px-4 py-2 rounded-full bg-pink-400 text-white font-bold border-0 shadow hover:bg-pink-500 transition" %>
                      <%= link_to "Toggle",
                            toggle_featured_admin_product_path(p),
                            data: { turbo_method: :patch },
                            class: "px-4 py-2 rounded-full font-bold shadow border-0 text-white transition
                              bg-gradient-to-r from-cyan-400 via-blue-500 to-indigo-500
                              hover:from-cyan-500 hover:via-blue-600 hover:to-indigo-700
                              focus:ring-2 focus:ring-cyan-300 focus:outline-none",
                            style: "min-width: 80px;" %>
                      <%= button_to "Delete",
                            admin_product_path(p),
                            method: :delete,
                            form: { data: { turbo_confirm: "Delete this product permanently?" } },
                            class: "px-4 py-2 rounded-full bg-rose-500 text-white font-bold border-0 shadow hover:bg-rose-700 transition" %>
                    </div>
                  </td>
                </tr>
              <% end %>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>

    <div class="mt-10 text-sm text-blue-400 text-center">
      Looking for advanced filters, charts, or more color? Let us know!
    </div>
  </div>
</main>