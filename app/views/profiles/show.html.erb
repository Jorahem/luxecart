<div class="max-w-xl mx-auto bg-white p-8 rounded-xl shadow-md mt-10">
  <div class="flex flex-col items-center">
    <%# Profile Avatar %>
    <div class="relative group mb-4">
      <% if current_user.profile_image.attached? %>
        <%= image_tag current_user.profile_image.variant(resize_to_fill: [96, 96]), alt: "Profile", class: "w-24 h-24 rounded-full object-cover border-4 border-indigo-500 shadow-lg" %>
      <% else %>
        <div class="w-24 h-24 rounded-full bg-gray-200 flex items-center justify-center border-4 border-indigo-500 shadow-lg text-4xl text-indigo-400">
          <i class="fa fa-user"></i>
        </div>
      <% end %>
      <div class="absolute bottom-0 right-0 p-1 bg-white rounded-full shadow border border-gray-200">
        <label class="cursor-pointer">
          <i class="fa fa-camera text-indigo-500"></i>
          <%= form_with model: current_user, url: profile_path, method: :patch, local: true, html: { multipart: true, style: "display:inline;" } do |f| %>
            <%= f.file_field :profile_image, class: "hidden", onchange: "this.form.submit();" %>
          <% end %>
        </label>
      </div>
    </div>

    <div class="text-center">
      <span class="font-semibold text-lg"> <%= [current_user.first_name, current_user.last_name].compact.join(" ").strip.presence || current_user.email.split('@')[0] %>
      <div class="text-gray-500 mb-2"><%= current_user.email %></div>
    </div>
  </div>

  <hr class="my-6">

  <div>
    <h3 class="text-lg font-semibold mb-2">Recent Orders</h3>
    <% if @recent_orders.any? %>
      <ul class="divide-y border rounded">
        <% @recent_orders.each do |order| %>
          <li class="py-3 px-2 flex justify-between items-center">
            <span>Order #<%= order.id %></span>
            <span class="text-gray-400"><%= l(order.created_at, format: :short) %></span>
            <span class="text-indigo-700 font-medium"><%= number_to_currency(order.total_price) %></span>
          </li>
        <% end %>
      </ul>
    <% else %>
      <p class="text-gray-400 py-4 text-center">No orders yet.</p>
    <% end %>
  </div>

  <div class="mt-8 text-center">
    <%= link_to "Change Password", edit_user_registration_path, class: "bg-gray-100 border border-gray-300 px-4 py-2 rounded-full hover:bg-indigo-50 hover:border-indigo-300 transition font-medium" %>
  </div>
</div>