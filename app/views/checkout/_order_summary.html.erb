<%# Right column order summary partial - clean layout %>
<div class="summary-details rounded-xl border border-gray-200 bg-white shadow-sm p-5 space-y-4">
  <%# Use @summary_items built in OrdersController#new (hashes with keys) %>
  <% summary_items = (@summary_items || []) %>

  <div class="flex items-center justify-between mb-2">
    <div>
      <h3 class="text-sm font-semibold text-gray-900 tracking-wide uppercase">Order Summary</h3>
      <p class="text-xs text-gray-500 mt-1">
        <%= pluralize(summary_items.sum { |i| i[:quantity].to_i }, "item") %> in your cart
      </p>
    </div>
    <div class="px-3 py-1 rounded-full bg-indigo-50 text-xs font-medium text-indigo-700">
      Secure checkout
    </div>
  </div>

  <%# Render list of cart items (simple) %>
  <ul class="summary-items divide-y divide-gray-100 border border-gray-100 rounded-lg bg-gray-50/60">
    <% summary_items.each do |item| %>
      <% product    = item[:product] %>
      <% quantity   = item[:quantity].to_i %>
      <% unit_price = item[:unit_price].to_d %>
      <% line_total = unit_price * quantity %>

      <li class="flex items-center justify-between px-3 py-2">
        <div class="flex-1 pr-2">
          <div class="text-xs font-medium text-gray-900 truncate">
            <%= product&.name || 'Product' %>
          </div>
          <div class="text-[11px] text-gray-500 mt-0.5">
            <%= pluralize(quantity, 'item') %> · <%= number_to_currency(unit_price) %> each
          </div>
        </div>
        <div class="text-xs font-semibold text-gray-900">
          <%= number_to_currency(line_total) %>
        </div>
      </li>
    <% end %>
  </ul>

  <%# Totals: compute from summary_items %>
  <% subtotal = summary_items.sum { |item| item[:unit_price].to_d * item[:quantity].to_i } %>
  <% tax      = (subtotal * 0.10).round(2) %>
  <% shipping = 9.99.to_d %>
  <% total    = (subtotal + tax + shipping).round(2) %>

  <div class="summary-totals mt-1 p-4 rounded-lg bg-white border border-gray-100 space-y-1.5 text-sm">
    <div class="flex items-center justify-between text-gray-700">
      <span>Items subtotal</span>
      <span><%= number_to_currency(subtotal) %></span>
    </div>

    <div class="flex items-center justify-between text-gray-700">
      <span>Shipping &amp; handling</span>
      <span><%= number_to_currency(shipping) %></span>
    </div>

    <div class="flex items-center justify-between text-xs text-gray-500 pt-1">
      <span>Before tax</span>
      <span><%= number_to_currency(subtotal + shipping) %></span>
    </div>

    <div class="flex items-center justify-between text-xs text-gray-500">
      <span>Tax collected (10%)</span>
      <span><%= number_to_currency(tax) %></span>
    </div>

    <hr class="my-2 border-gray-200">

    <div class="flex items-center justify-between text-base font-semibold">
      <span class="text-gray-900">Order total</span>
      <span class="text-indigo-600 text-lg"><%= number_to_currency(total) %></span>
    </div>
  </div>

  <div class="mt-2 flex items-center gap-2 text-[11px] text-gray-500">
    <span class="inline-flex h-5 w-5 items-center justify-center rounded-full bg-green-50 text-green-600 text-xs border border-green-100">
      ✓
    </span>
    <span>All transactions are secured and encrypted.</span>
  </div>
</div>