<%# Home#index - interactive landing page with animations, images and product highlights %>

<div class="space-y-12" data-page="home">

  <!-- HERO GALLERY -->
  <section class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4 fade-in-up">
    <div class="col-span-2 relative rounded-2xl overflow-hidden shadow-xl group">
      <div class="relative h-72 md:h-96 bg-gray-100">
        <img
          src="https://images.unsplash.com/photo-1512436991641-6745cdb1723f?auto=format&fit=crop&w=1600&q=80"
          alt="Stylish clothes and accessories in a boutique"
          class="w-full h-full object-cover transform group-hover:scale-105 transition-transform duration-700"
          loading="lazy"
        />
        <div class="absolute inset-0 bg-gradient-to-tr from-black/60 via-black/40 to-transparent flex flex-col justify-center p-6 md:p-10">
          <p class="inline-flex items-center px-3 py-1 rounded-full bg-white/10 text-xs md:text-sm text-white/80 mb-3 backdrop-blur">
            <span class="w-2 h-2 rounded-full bg-emerald-400 mr-2 animate-pulse"></span>
            New drops every week
          </p>
          <h1 class="text-3xl md:text-5xl text-white font-extrabold leading-tight mb-3 drop-shadow">
            Discover premium picks at <span class="text-emerald-300">LuxeCart</span>
          </h1>
          <p class="text-white/90 max-w-2xl mb-6 text-sm md:text-base">
            Handpicked styles, curated collections and luxury deals â€” all with a smooth shopping experience.
          </p>
          <div class="flex flex-wrap gap-3">
            <%= link_to products_path, class: "inline-flex items-center gap-2 px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-semibold shadow-lg shadow-indigo-500/30 transition-transform hover:-translate-y-0.5" do %>
              <i class="fa-solid fa-bag-shopping"></i>
              <span>Shop featured</span>
            <% end %>

            <%= link_to categories_path, class: "inline-flex items-center gap-2 px-6 py-3 bg-white/90 hover:bg-white text-indigo-700 rounded-lg font-semibold shadow-md transition-transform hover:-translate-y-0.5" do %>
              <i class="fa-solid fa-grid-2"></i>
              <span>Explore categories</span>
            <% end %>
          </div>
        </div>
      </div>
    </div>

    <div class="flex flex-col gap-4">
      <!-- Left small image -->
      <div class="h-36 md:h-44 rounded-2xl overflow-hidden shadow-lg relative slide-in-right delay-1">
        <img
          src="https://images.unsplash.com/photo-1521572163474-4f4e0f0af0c5?auto=format&fit=crop&w=900&q=80"
          alt="Person choosing clothes on a rack"
          class="w-full h-full object-cover transform hover:scale-105 transition-transform duration-700"
          loading="lazy"
        />
        <div class="absolute inset-0 bg-black/35 flex items-end p-3">
          <span class="text-white text-sm font-semibold">Curated styles</span>
        </div>
      </div>

      <!-- Right small image -->
      <div class="h-36 md:h-44 rounded-2xl overflow-hidden shadow-lg relative slide-in-right delay-2">
        <img
          src="https://images.unsplash.com/photo-1543076447-215ad9ba6923?auto=format&fit=crop&w=900&q=80"
          alt="Folded clothes and accessories on display"
          class="w-full h-full object-cover transform hover:scale-105 transition-transform duration-700"
          loading="lazy"
        />
        <div class="absolute inset-0 bg-black/35 flex items-end p-3">
          <span class="text-white text-sm font-semibold">Fresh arrivals</span>
        </div>
      </div>
    </div>
  </section>

  <!-- SHOP BY CATEGORY (interactive pills) -->
  <section class="fade-in-up delay-1">
    <div class="flex items-center justify-between mb-4">
      <div>
        <h2 class="text-xl md:text-2xl font-bold">Shop by category</h2>
        <p class="text-sm text-gray-500">Jump into our most popular departments.</p>
      </div>
      <%= link_to "View all", categories_path, class: "text-sm text-indigo-600 hover:text-indigo-700 font-medium" %>
    </div>

    <div class="flex gap-3 overflow-x-auto pb-2 hide-scrollbar">
      <%= link_to products_path(category: "shoes"), class: "inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gray-900 text-white text-sm hover:bg-black transition-colors whitespace-nowrap shadow-sm" do %>
        <i class="fa-solid fa-shoe-prints"></i>
        <span>Shoes</span>
      <% end %>

      <%= link_to products_path(category: "men"), class: "inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gray-100 text-gray-800 text-sm hover:bg-gray-200 transition-colors whitespace-nowrap" do %>
        <i class="fa-solid fa-person"></i>
        <span>Men</span>
      <% end %>

      <%= link_to products_path(category: "women"), class: "inline-flex items-center gap-2 px-4 py-2 rounded-full bg-pink-50 text-pink-700 text-sm hover:bg-pink-100 transition-colors whitespace-nowrap" do %>
        <i class="fa-solid fa-person-dress"></i>
        <span>Women</span>
      <% end %>

      <%= link_to products_path(category: "kids"), class: "inline-flex items-center gap-2 px-4 py-2 rounded-full bg-emerald-50 text-emerald-700 text-sm hover:bg-emerald-100 transition-colors whitespace-nowrap" do %>
        <i class="fa-solid fa-child-reaching"></i>
        <span>Kids</span>
      <% end %>

      <%= link_to products_path(q: "accessories"), class: "inline-flex items-center gap-2 px-4 py-2 rounded-full bg-indigo-50 text-indigo-700 text-sm hover:bg-indigo-100 transition-colors whitespace-nowrap" do %>
        <i class="fa-solid fa-gem"></i>
        <span>Accessories</span>
      <% end %>
    </div>
  </section>

  <!-- FEATURED PRODUCTS (larger grid) -->
  <section class="fade-in-up delay-2">
    <div class="flex items-center justify-between mb-4">
      <h2 class="text-2xl font-bold">Featured products</h2>
      <%= link_to "See all products", products_path, class: "text-sm text-indigo-600 hover:text-indigo-700 font-medium" %>
    </div>

    <div class="grid gap-6 grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4">
      <% products = @featured_products.presence || [] %>
      <% if products.any? %>
        <% # fallback images we cycle through when a product has no attached image %>
        <% featured_fallback_images = [
             "https://images.unsplash.com/photo-1519710164239-da123dc03ef4?auto=format&fit=crop&w=1200&q=80", # shoes on display
             "https://images.unsplash.com/photo-1512436991641-6745cdb1723f?auto=format&fit=crop&w=1200&q=80", # clothes rail
             "https://images.unsplash.com/photo-1521572163474-4f4e0f0af0c5?auto=format&fit=crop&w=1200&q=80", # picking clothes
             "https://images.unsplash.com/photo-1528701800489-20be3c30c1d5?auto=format&fit=crop&w=1200&q=80", # product still life
             "https://images.unsplash.com/photo-1519744792095-2f2205e87b6f?auto=format&fit=crop&w=1200&q=80", # desk accessories
             "https://images.unsplash.com/photo-1514996937319-344454492b37?auto=format&fit=crop&w=1200&q=80", # sneakers
             "https://images.unsplash.com/photo-1495121553079-4c61bcce189c?auto=format&fit=crop&w=1200&q=80", # folded clothes
             "https://images.unsplash.com/photo-1522312346375-d1a52e2b99b3?auto=format&fit=crop&w=1200&q=80"  # watch / accessory
           ] %>

        <% products.each_with_index do |product, index| %>
          <% fallback_img = featured_fallback_images[index % featured_fallback_images.size] %>

          <article class="bg-white rounded-2xl shadow-sm hover:shadow-lg transition-shadow duration-300 flex flex-col overflow-hidden group">
            <div class="h-44 mb-0 overflow-hidden bg-gray-100 flex items-center justify-center relative">
              <%# Product image (ActiveStorage) or different fallback per card %>
              <% if product.respond_to?(:image) && product.image.respond_to?(:attached?) && product.image.attached? %>
                <%= image_tag url_for(product.image), alt: product.name, class: "w-full h-full object-cover transform group-hover:scale-105 transition-transform duration-500" %>
              <% else %>
                <%= image_tag fallback_img, alt: "Product image", class: "w-full h-full object-cover transform group-hover:scale-105 transition-transform duration-500" %>
              <% end %>

              <div class="absolute top-3 left-3">
                <span class="inline-flex items-center px-2 py-1 rounded-full text-[10px] font-semibold bg-black/70 text-white uppercase tracking-wide">
                  Featured
                </span>
              </div>
            </div>

            <div class="p-4 flex flex-col flex-1">
              <h3 class="font-semibold mb-1 truncate"><%= product.name %></h3>
              <p class="text-sm text-gray-500 line-clamp-2 mb-2"><%= product.description.to_s.truncate(80) %></p>

              <div class="mt-auto flex items-center justify-between">
                <div class="font-bold text-lg text-gray-900">
                  <% if product.respond_to?(:price) && product.price.present? %>
                    <%= number_to_currency(product.price) %>
                  <% elsif product.respond_to?(:price_cents) && product.price_cents.present? %>
                    <%= number_to_currency(BigDecimal(product.price_cents) / 100) %>
                  <% else %>
                    <span class="text-gray-400 text-sm">Price on request</span>
                  <% end %>
                </div>

                <div class="flex items-center gap-2">
                  <%= link_to product_path(product), class: "inline-flex items-center justify-center w-9 h-9 rounded-full border border-gray-200 text-gray-600 hover:bg-gray-100 transition-colors" do %>
                    <i class="fa-solid fa-eye text-sm"></i>
                  <% end %>

                  <button
                    type="button"
                    class="add-to-cart-ajax inline-flex items-center justify-center w-9 h-9 rounded-full bg-indigo-600 text-white hover:bg-indigo-700 text-sm shadow-sm transition-transform hover:-translate-y-0.5"
                    data-url="/cart/add_item"
                    data-product-id="<%= product.id %>">
                    <i class="fa-solid fa-cart-plus"></i>
                  </button>
                </div>
              </div>
            </div>
          </article>
        <% end %>
      <% else %>
        <div class="col-span-full text-center text-gray-500 py-12">
          No featured products yet. Once you add products and mark them as featured, they will appear here.
        </div>
      <% end %>
    </div>
  </section>
 

  <!-- WHY LUXECART (value props) -->
  <section class="grid grid-cols-1 md:grid-cols-3 gap-6 fade-in-up delay-3">
    <div class="bg-white rounded-2xl shadow-sm p-5 flex gap-3 items-start">
      <div class="w-10 h-10 rounded-full bg-emerald-100 text-emerald-700 flex items-center justify-center">
        <i class="fa-solid fa-truck-fast"></i>
      </div>
      <div>
        <h3 class="font-semibold mb-1">Fast & reliable shipping</h3>
        <p class="text-sm text-gray-500">
          Get your favorites delivered quickly with tracking from checkout to your doorstep.
        </p>
      </div>
    </div>

    <div class="bg-white rounded-2xl shadow-sm p-5 flex gap-3 items-start">
      <div class="w-10 h-10 rounded-full bg-indigo-100 text-indigo-700 flex items-center justify-center">
        <i class="fa-solid fa-shield-heart"></i>
      </div>
      <div>
        <h3 class="font-semibold mb-1">Secure payment</h3>
        <p class="text-sm text-gray-500">
          Powered by trusted payment gateways so you can shop with confidence.
        </p>
      </div>
    </div>

    <div class="bg-white rounded-2xl shadow-sm p-5 flex gap-3 items-start">
      <div class="w-10 h-10 rounded-full bg-amber-100 text-amber-700 flex items-center justify-center">
        <i class="fa-solid fa-arrow-rotate-left"></i>
      </div>
      <div>
        <h3 class="font-semibold mb-1">Easy returns</h3>
        <p class="text-sm text-gray-500">
          Simple return policy on eligible items to keep your experience smooth.
        </p>
      </div>
    </div>
  </section>


  <!-- TRENDING STRIP -->
  <section class="fade-in-up delay-4">
    <div class="flex items-center justify-between mb-3">
      <h2 class="text-lg font-semibold">Trending right now</h2>
      <span class="text-xs uppercase tracking-wide text-emerald-600 font-semibold flex items-center gap-1">
        <span class="w-1.5 h-1.5 rounded-full bg-emerald-400 animate-pulse"></span> Live
      </span>
    </div>

    <div class="flex gap-4 overflow-x-auto pb-2 hide-scrollbar">
      <% trending = (@trending_products || @featured_products || []).first(8) %>

      <% # Fallback images to cycle through when a product has no attached image %>
      <% fallback_trending_images = [
           "https://images.unsplash.com/photo-1512436991641-6745cdb1723f?auto=format&fit=crop&w=600&q=80",  # clothes rail
           "https://images.unsplash.com/photo-1514996937319-344454492b37?auto=format&fit=crop&w=600&q=80",  # shoes
           "https://images.unsplash.com/photo-1528701800489-20be3c30c1d5?auto=format&fit=crop&w=600&q=80",  # product still life
           "https://images.unsplash.com/photo-1519741497674-611481863552?auto=format&fit=crop&w=600&q=80",  # accessories
           "https://images.unsplash.com/photo-1518806118471-f28b20a1d79d?auto=format&fit=crop&w=600&q=80",  # sneakers
           "https://images.unsplash.com/photo-1495121553079-4c61bcce189c?auto=format&fit=crop&w=600&q=80",  # folded clothes
           "https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?auto=format&fit=crop&w=600&q=80",  # models
           "https://images.unsplash.com/photo-1522312346375-d1a52e2b99b3?auto=format&fit=crop&w=600&q=80"   # watch/accessory
         ] %>

      <% trending.each_with_index do |product, idx| %>
        <% fallback_img = fallback_trending_images[idx % fallback_trending_images.size] %>

        <%= link_to product_path(product), class: "min-w-[180px] bg-white rounded-2xl shadow-sm hover:shadow-md transition-shadow p-3 flex flex-col" do %>
          <div class="h-24 mb-2 rounded-xl overflow-hidden bg-gray-100 flex items-center justify-center">
            <% if product.respond_to?(:image) && product.image.respond_to?(:attached?) && product.image.attached? %>
              <%= image_tag url_for(product.image), alt: product.name, class: "w-full h-full object-cover" %>
            <% else %>
              <%= image_tag fallback_img, alt: "Trending product", class: "w-full h-full object-cover" %>
            <% end %>
          </div>
          <div class="text-xs text-gray-500 mb-1 truncate"><%= product.category.try(:name) if product.respond_to?(:category) %></div>
          <div class="text-sm font-semibold truncate"><%= product.name %></div>
        <% end %>
      <% end %>
    </div>
  </section>





  <!-- CTA STRIP -->
  <section class="bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-500 rounded-2xl px-6 py-6 md:px-8 md:py-7 flex flex-col md:flex-row items-center justify-between gap-4 fade-in-up delay-5">
    <div>
      <h2 class="text-xl md:text-2xl font-bold text-white mb-1">Ready to upgrade your wardrobe?</h2>
      <p class="text-sm text-white/80 max-w-xl">
        Create an account to save favorites, track orders and enjoy a faster checkout experience.
      </p>
    </div>

    <div class="flex gap-3">
      <% if user_signed_in? %>
        <%= link_to "Continue shopping", products_path, class: "inline-flex items-center gap-2 px-5 py-2.5 bg-white text-indigo-700 rounded-lg font-semibold shadow-md hover:bg-gray-50 transition-colors" %>
      <% else %>
        <%= link_to new_user_registration_path, class: "inline-flex items-center gap-2 px-5 py-2.5 bg-white text-indigo-700 rounded-lg font-semibold shadow-md hover:bg-gray-50 transition-colors" do %>
          <i class="fa-solid fa-user-plus"></i>
          <span>Create account</span>
        <% end %>
        <%= link_to new_user_session_path, class: "inline-flex items-center gap-2 px-5 py-2.5 border border-white/50 text-white rounded-lg font-semibold hover:bg-white/10 transition-colors" do %>
          <i class="fa-solid fa-right-to-bracket"></i>
          <span>Login</span>
        <% end %>
      <% end %>
    </div>
  </section>
</div>

<%# Tiny animation helper (no external library needed) %>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const animated = document.querySelectorAll('[data-page="home"] .fade-in-up, [data-page="home"] .slide-in-right');
    animated.forEach((el) => {
      el.classList.add('opacity-0', 'translate-y-4');
    });

    function reveal() {
      const trigger = window.innerHeight * 0.9;
      animated.forEach((el) => {
        const rect = el.getBoundingClientRect();
        if (rect.top < trigger) {
          el.classList.remove('opacity-0', 'translate-y-4');
          el.classList.add('transition-all', 'duration-700', 'opacity-100', 'translate-y-0');
        }
      });
    }

    reveal();
    window.addEventListener('scroll', reveal);
  });
</script>

<style>
  /* Hide scrollbars for horizontal strips */
  .hide-scrollbar::-webkit-scrollbar { display: none; }
  .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

  /* Simple delay utilities (used with fade-in-up / slide-in-right) */
  .delay-1 { transition-delay: 0.05s; }
  .delay-2 { transition-delay: 0.1s; }
  .delay-3 { transition-delay: 0.15s; }
  .delay-4 { transition-delay: 0.2s; }
  .delay-5 { transition-delay: 0.25s; }
</style>