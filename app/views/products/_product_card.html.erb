<div class="rounded-lg border p-4 bg-white flex flex-col h-full">
  <%# product variable expected in local assigns %>



    <%# SIMPLE IMAGE SETUP FOR PRODUCT CARD (BY PRODUCT NAME) %>
  <% card_image_url =
       case product.name
       when "Modern Floor Lamp"
         "https://images.unsplash.com/photo-1505691723518-36a5ac3be353?auto=format&fit=crop&w=800&q=80"
       when "Handwoven Rug"
         "https://images.unsplash.com/photo-1545239351-1141bd82e8a6?auto=format&fit=crop&w=800&q=80"
       when "Oak Coffee Table"
         "https://images.unsplash.com/photo-1505691723518-36a5ac3be353?auto=format&fit=crop&w=800&q=80"
       when "Ceramic Vase Set"
         "https://images.unsplash.com/photo-1519710164239-da123dc03ef4?auto=format&fit=crop&w=800&q=80"
       when "Minimalist Bookshelf"
         "https://images.unsplash.com/photo-1519710164239-da123dc03ef4?auto=format&fit=crop&w=800&q=80"
       when "Designer Throw Pillow"
         "https://images.unsplash.com/photo-1523755231516-e43fd2e8dca5?auto=format&fit=crop&w=800&q=80"
       when "Contemporary Wall Art"
         "https://images.unsplash.com/photo-1505691723518-36a5ac3be353?auto=format&fit=crop&w=800&q=80"
       when "Nordic Dining Chair"
         "https://images.unsplash.com/photo-1531297484001-80022131f5a1?auto=format&fit=crop&w=800&q=80"
       else
         nil
       end %>

  <%# Fallbacks: model fields / attachment / placeholder if no custom URL above %>
  <% unless card_image_url.present? %>
    <% if product.respond_to?(:image_url) && product.image_url.present? %>
      <% card_image_url = product.image_url %>
    <% elsif product.respond_to?(:image) &&
          product.image.respond_to?(:attached?) &&
          product.image.attached? %>
      <% card_image_url = url_for(product.image) %>
    <% end %>
  <% end %>

  <% card_image_url ||= "https://via.placeholder.com/400x300?text=No+Image" %>

  <%= link_to product_path(product), class: "block mb-3" do %>
    <img src="<%= card_image_url %>"
         alt="<%= h(product.name) %>"
         class="w-full h-40 object-cover rounded-md">
  <% end %>













  <div class="flex-1">
    <h3 class="text-sm font-semibold text-gray-900 mb-1">
      <%= link_to product.name, product_path(product), class: "hover:underline" %>
    </h3>

    <% if product.respond_to?(:short_description) && product.short_description.present? %>
      <p class="text-xs text-gray-500 mb-2"><%= truncate(product.short_description, length: 80) %></p>
    <% end %>

    <div class="text-gray-800 font-medium mb-3"><%= number_to_currency(product.try(:price) || 0) %></div>
  </div>

  <div class="mt-2 grid grid-cols-2 gap-2">
    <%# Primary Add button â€” uses JS handler (data attributes) and falls back gracefully %>
    <%= button_tag type: :button,
                   class: "add-to-cart-ajax inline-flex items-center justify-center px-3 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-sm w-full",
                   data: { url: (defined?(cart_add_item_path) ? cart_add_item_path : '/cart/add_item'), product_id: product.id },
                   aria: { label: "Add #{product.name} to cart" } do %>
      <i class="fa-solid fa-cart-plus mr-2"></i>
      Add
    <% end %>

    <%# Optional: Quick view or details link %>
    <%= link_to product_path(product), class: "inline-flex items-center justify-center px-3 py-2 border rounded-md text-sm text-gray-700 hover:bg-gray-50 w-full", title: "View details for #{product.name}" do %>
      <i class="fa-solid fa-eye mr-2"></i> View
    <% end %>
  </div>
</div>